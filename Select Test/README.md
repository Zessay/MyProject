&emsp;最近帮导师用Python帮老师做了一个小的应用程序，主要实现让学生选择考试题目并以excel的形式存储的功能。这里写一下设计的过程、思路以及遇到的问题。



> 该小工具需求如下：

- 读取存储学生信息的excel表格；
- 学生在输入框输入自己的学号，点击可选择的4种考试类型按钮中的其中一个（包括A, B, C, D），其中A类共有10套考题，B类共有10套考题，C类共有10套考题，D类有2套考题；
- 代码获取学生的输入并查找相匹配的学号，从表格中获取学生的名字，将姓名和所选题目输出到应用程序上，将考题保存在数组中；
- 点击关闭窗口时，程序将数组中最终的数据保存到excel表格中。



> 思路

- 首先实现内部逻辑，也就是**读excel存储为dataframe类型 —> 将数据转换成numpy数组型 —> 获取用户输入学号 —> 用户输入“A, B, C, D”中其中一个 —> 在数组中查找学号并以元组形式返回(row, column) —> 根据所在row获取用户姓名的位置 —> 用随机函数在固定范围中选择考试题目 —> 将考试题目保存在数组中 —> 打印用户姓名以及随机的考试题目**
- 接着使用Python的GUI库`tkinter`进行可视化，内容包括**指示输入学号的文本，获取学号的文本框，`A` `B` `C` `D` 四个选择按钮，退出显示保存文件**



> 遇到的问题及解决方法

- 在将数据转换为numpy数组时，发现其中一些数据由于*合并单元格* 的原因，只在一个位置获取了数值，起一个位置默认为`nan`，表示是缺失值。首先想到使用`np.isnan()`函数判断位置是否丢失，如果丢失，用前一行相同列数据补齐。但是发现这里`np.isnan()`函数并无法起作用，无论是否为`nan`值，输出均为`False`。**通常上网查找，发现了解决问题的方法`str(获取该值) == 'nan'`来判断该位置是否为`nan`，可以解决问题**。
- `tkinter`库中的`Butoon`挂件中有一个`bind()`函数，用来执行对鼠标命令的反馈，其中有一个位置参数是执行反馈的函数，但是该函数无法传入参数，也就是说只能是一个无参函数，而这里无法满足我们的需求。**通过上网查找，可以通过==事件处理函数适配器==来解决，具体如下：

```python
def handlerAdaptor(fun, **kwds):
    return lambda event, fun = fun, kwds=kwds:fun(event, **kwds)
```

&emsp;这是一个==中介函数==，通过这个函数，在`bind`的位置参数上通过`handlerAdaptor(反馈函数名, 参数1, 参数2 ...)`即可传入参数，其中的参数`event`是一个表示事件的参数，并不需要传入值。

&emsp;同样的方法可以解决最后关闭窗口是使用的`protocol`中遇到的问题。

- 还有一个比较重要的问题是，每次打开程序，文件中之前考题选择的数据就会被清空。暂时没有解决这个问题，原因是如果刚打开时原文件中该列为空，那么转换为`dataframe`时会自动转换`nan`值，这样导致后面生成的numpy数组中数据的变化无法在`dataframe`中同步。目前还没想到很好的方法解决这个问题，这也是之后需要改进的地方。



